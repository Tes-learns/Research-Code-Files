---
title: "RMSE over K's plot"
author: "Itesiwajuayo Babalola"
date: "2025-11-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, echo=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
```


## Scenario 1

```{r s1}

scenario1 <- data.frame(
Parameter = c("mu1", "mu2", "mu3", "tau2_1", "tau2_2", "tau2_3", "pi1", "pi2", "pi3"),
K150  = c(0.67040477, 0.77184890, 0.24916968, 0.52865151, 0.68278485, 0.28718817, 0.14315924, 0.12150552, 0.06890731),
K500  = c(0.48686487, 0.40921551, 0.13877419, 0.41612027, 0.59636886, 0.19074553, 0.11546375, 0.10992732, 0.03898538),
K1000 = c(0.41349455, 0.30079057, 0.11054010, 0.35346858, 0.51776149, 0.14731519, 0.10650265, 0.10547836, 0.03127688),
K1500 = c(0.38587080, 0.27598255, 0.08762364, 0.30211838, 0.40286566, 0.11854734, 0.10413471, 0.10435473, 0.02469001)
)

scenario1_long <- scenario1 %>%
pivot_longer(starts_with("K"), names_to = "K", values_to = "RMSE") %>%
mutate(K = as.numeric(gsub("K", "", K)))

ggplot(scenario1_long, aes(x = K, y = RMSE, color = Parameter, group = Parameter)) +
geom_line(linewidth = 1) + geom_point(size = 2) +
theme_minimal(base_size = 13) +
labs(x = "Number of Studies (K)", y = "RMSE", color = "Parameter") +
scale_x_continuous(breaks = c(150, 500, 1000, 1500))


```

## Scenario 2

```{r s2}

scenario2 <- data.frame(
Parameter = c("mu1", "mu2", "tau2_1", "tau2_2", "pi1", "pi2"),
K150  = c(0.4778133, 0.4150743, 0.3820868, 0.2671641, 0.1863864, 0.1863864),
K500  = c(0.2842555, 0.2514844, 0.2445168, 0.1921082, 0.1408853, 0.1408853),
K1000 = c(0.2611372, 0.2177994, 0.2006315, 0.1562850, 0.1307240, 0.1307240),
K1500 = c(0.1991623, 0.1813278, 0.1644761, 0.1373862, 0.1084464, 0.1084464)
)

scenario2_long <- scenario2 %>%
pivot_longer(starts_with("K"), names_to = "K", values_to = "RMSE") %>%
mutate(K = as.numeric(gsub("K", "", K)))

ggplot(scenario2_long, aes(x = K, y = RMSE, color = Parameter, group = Parameter)) +
geom_line(linewidth = 1) + geom_point(size = 2) +
theme_minimal(base_size = 13) +
labs(x = "Number of Studies (K)", y = "RMSE", color = "Parameter") +
scale_x_continuous(breaks = c(150, 500, 1000, 1500))

```

## Scenario 3

```{r s3}
scenario3 <- data.frame(
Parameter = c("mu1", "mu2", "tau2_1", "tau2_2", "pi1", "pi2"),
K150  = c(1.3348927, 0.6246681, 1.4091233, 0.7413643, 0.2289934, 0.2289934),
K500  = c(0.7283115, 0.2978475, 0.9398239, 0.4394450, 0.1613955, 0.1613955),
K1000 = c(0.4530323, 0.1903813, 0.6109227, 0.2705537, 0.1081558, 0.1081558),
K1500 = c(0.3947530, 0.1430142, 0.5187588, 0.2068493, 0.0941793, 0.0941793)
)

scenario3_long <- scenario3 %>%
pivot_longer(starts_with("K"), names_to = "K", values_to = "RMSE") %>%
mutate(K = as.numeric(gsub("K", "", K)))

ggplot(scenario3_long, aes(x = K, y = RMSE, color = Parameter, group = Parameter)) +
geom_line(linewidth = 1) + geom_point(size = 2) +
theme_minimal(base_size = 13) +
labs(x = "Number of Studies (K)", y = "RMSE", color = "Parameter") +
scale_x_continuous(breaks = c(150, 500, 1000, 1500))


```

## Scenario 4

```{r s4}
scenario4 <- data.frame(
Parameter = c("mu1", "tau2_1", "pi1"),
K150  = c(0.09992471, 0.14785288, 0.00000000),
K500  = c(0.04972861, 0.08477210, 0.00000000),
K1000 = c(0.03569040, 0.05777234, 0.00000000),
K1500 = c(0.03034144, 0.04679992, 0.00000000)
)

scenario4_long <- scenario4 %>%
pivot_longer(starts_with("K"), names_to = "K", values_to = "RMSE") %>%
mutate(K = as.numeric(gsub("K", "", K)))

ggplot(scenario4_long, aes(x = K, y = RMSE, color = Parameter, group = Parameter)) +
geom_line(linewidth = 1) + geom_point(size = 2) +
theme_minimal(base_size = 13) +
labs(x = "Number of Studies (K)", y = "RMSE", color = "Parameter") +
scale_x_continuous(breaks = c(150, 500, 1000, 1500))

```

